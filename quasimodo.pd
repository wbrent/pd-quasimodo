#N canvas 120 189 820 773 12;
#X declare -path ./lib;
#X obj 127 665 dac~ 2;
#N canvas 970 146 499 437 init 0;
#X obj 55 44 loadbang;
#X msg 55 302 \; pd dsp 1 \;;
#X obj 246 366 declare -path ./lib;
#X obj 55 68 t b b b;
#X msg 108 237 \; delay-deltime-set 100 \;;
#X msg 168 127 \; remote-direct-gain-set -24 \; remote-amplification-gain-set
-12 \; instrument-gain-set -12 \; room-mic-gain-set -6 \;;
#X connect 0 0 3 0;
#X connect 3 0 1 0;
#X connect 3 1 4 0;
#X connect 3 2 5 0;
#X restore 734 715 pd init;
#X obj 47 105 vumeter;
#N canvas 730 490 365 387 variable-delay 0;
#X obj 23 36 inlet~;
#X obj 23 306 outlet~;
#N canvas 1028 167 498 300 delay-write 0;
#X msg 84 115 clear;
#X obj 41 46 inlet~;
#X obj 41 236 outlet~;
#X obj 41 151 delwrite~ \$0-quasi-delay 5000;
#X obj 84 90 r delay-clear;
#X connect 0 0 3 0;
#X connect 1 0 3 0;
#X connect 4 0 0 0;
#X restore 23 109 pd delay-write;
#N canvas 1186 67 420 552 delay-read 0;
#X obj 41 46 inlet~;
#X obj 41 486 outlet~;
#X obj 41 426 delread4~ \$0-quasi-delay 1000;
#X obj 170 295 +~ 50;
#X text 223 293 minimum delay is 50ms;
#X obj 170 199 r delay-deltime;
#X obj 170 223 pack f 1000;
#X obj 170 247 line~;
#X connect 2 0 1 0;
#X connect 3 0 2 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 3 0;
#X restore 23 186 pd delay-read;
#X obj 210 160 bng 15 250 50 0 delay-clear empty c 17 7 0 12 -261234
-1 -1;
#X floatatom 210 130 10 0 0 1 ms delay-deltime-set delay-deltime;
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X coords 0 -1 1 1 110 85 1 200 100;
#X restore 127 545 pd variable-delay;
#N canvas 379 74 1198 376 capture-local-mic-signal 0;
#X obj 40 291 outlet~;
#X obj 40 51 inlet~;
#X obj 304 130 dbtorms;
#X obj 304 154 pack f 40;
#X obj 304 178 line~;
#X obj 230 122 *~;
#X obj 40 75 +~;
#X floatatom 756 125 5 -100 12 1 instrument-gain instrument-gain-set
instrument-gain;
#X text 243 229 Here \, we capture the local mic signal and mix it
with the remote-direct signal. Note that the mic signal will contain
the room-amplified version of the remote signal as well.;
#X obj 230 52 inlet~;
#X obj 304 84 + 100;
#X floatatom 756 147 5 -100 12 1 room-mic-gain room-mic-gain-set room-mic-gain
;
#X obj 544 130 dbtorms;
#X obj 544 154 pack f 40;
#X obj 544 178 line~;
#X obj 470 122 *~;
#X obj 470 52 inlet~;
#X obj 544 84 + 100;
#X obj 304 60 r instrument-gain;
#X obj 544 60 r room-mic-gain;
#X obj 40 99 +~;
#X connect 1 0 6 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 1;
#X connect 5 0 6 1;
#X connect 6 0 20 0;
#X connect 9 0 5 0;
#X connect 10 0 2 0;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 14 0 15 1;
#X connect 15 0 20 1;
#X connect 16 0 15 0;
#X connect 17 0 12 0;
#X connect 18 0 10 0;
#X connect 19 0 17 0;
#X connect 20 0 0 0;
#X coords 0 -1 1 1 240 70 1 750 100;
#X restore 127 465 pd capture-local-mic-signal;
#N canvas 196 108 939 391 receive-from-previous-player 0;
#X obj 41 291 outlet~;
#X obj 41 51 inlet~;
#X text 228 26 First \, we receive audio from the previous link in
the chain and send it straight out to the local loudspeaker;
#X obj 305 160 dbtorms;
#X obj 305 184 pack f 40;
#X obj 305 208 line~;
#X obj 231 152 *~;
#X floatatom 560 130 5 -100 12 1 remote-direct-gain remote-direct-gain-set
remote-direct-gain;
#X obj 115 160 dbtorms;
#X obj 115 184 pack f 40;
#X obj 115 208 line~;
#X obj 41 152 *~;
#X floatatom 560 160 5 -100 12 1 remote-amplification-gain remote-amplification-gain-set
remote-amplification-gain;
#X obj 231 252 outlet~;
#X obj 115 90 r remote-direct-gain;
#X obj 305 90 r remote-amplification-gain;
#X obj 305 114 + 100;
#X obj 115 114 + 100;
#X connect 1 0 6 0;
#X connect 1 0 11 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 6 1;
#X connect 6 0 13 0;
#X connect 8 0 9 0;
#X connect 9 0 10 0;
#X connect 10 0 11 1;
#X connect 11 0 0 0;
#X connect 14 0 17 0;
#X connect 15 0 16 0;
#X connect 16 0 3 0;
#X connect 17 0 8 0;
#X coords 0 -1 1 1 240 85 1 550 100;
#X restore 127 105 pd receive-from-previous-player;
#X obj 360 301 dac~ 1;
#X obj 360 351 adc~ 1;
#X obj 380 391 vumeter;
#X text 417 299 << route this signal (pure_data:output0) to your local
loudspeaker, f 40;
#X text 124 696 Route this signal (pure_data:output1) to the next player's
JackTrip send, f 39;
#X obj 360 220 rvb-module;
#X obj 127 219 rvb-module;
#X obj 127 65 adc~ 3;
#X text 124 26 Route the previous player's JackTrip receive to this
input of Pd (pure_data:input2), f 45;
#X text 417 349 << route your direct instrument signal to this input
of Pd (pure_data:input0), f 39;
#X obj 485 448 vumeter;
#X obj 465 408 adc~ 2;
#X text 522 406 << route your room mic signal to this input of Pd (pure_data:input1)
, f 39;
#X text 472 217 << add some cheap reverb to smooth out the signal if
desired, f 22;
#X connect 3 0 0 0;
#X connect 4 0 3 0;
#X connect 5 0 12 0;
#X connect 5 1 11 0;
#X connect 7 0 8 0;
#X connect 7 0 4 1;
#X connect 11 0 6 0;
#X connect 12 0 4 0;
#X connect 13 0 5 0;
#X connect 13 0 2 0;
#X connect 17 0 16 0;
#X connect 17 0 4 2;
